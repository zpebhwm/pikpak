import{d as b,r as i,m as N,o as _,s as F,b as r,e as l,aj as v,w as n,c as g,M as A,F as f,U as h,G as x,B as P,ab as U,y as E,A as w,ae as C,af as O,D as T}from"./vendor.fd74a6b1.js";import{n as L,i as S}from"./index.61c15b89.js";const M={class:"list-page"},H=f("a",{href:"https://t.me/shabitt",target:"_blank"},"\u4F5C\u8005",-1),j=f("a",{href:"https://shimily.notion.site/shimily/f90e8e28b55e423185f44c89c53c573c?v=b69a268a91c946ce9238f947100070a4",target:"_blank"},"\u5730\u5740",-1),z=f("br",null,null,-1),V=E(" \u8BF7\u5148\u5728\u6587\u4EF6\u5217\u8868\u64CD\u4F5C\u9009\u62E9\u8BBE\u7F6E\u9ED8\u8BA4 "),Y=f("br",null,null,-1),W={key:0,class:"loading"},K=E("\u52A0\u8F7D\u4E2D "),G=b({setup(R){const c=i([]),u=i(),d=i(!1),o=i(),y=()=>{d.value=!0,L.post("https://api.notion.com/v1/databases/f90e8e28b55e423185f44c89c53c573c/query",{start_cursor:o.value||void 0,page_size:50}).then(e=>{if(d.value=!1,o.value||(u.value=[]),u.value=u.value.concat(e.data.results),o.value=e.data.has_more&&e.data.next_cursor,c.value.length==0){if(u.value.length)for(let t in u.value[0].properties)c.value.push({title:t,key:t,ellipsis:{tooltip:{placement:"right"}},width:t==="\u540D\u79F0"?600:150,render:s=>{const a=s.properties[t];switch(a.type){case"rich_text":case"title":return h("div",{},{default:()=>a[a.type]&&a[a.type].length&&a[a.type].map(B=>B.plain_text)});case"select":return h("div",{style:{color:s.properties[t].select.color}},a.select.name);case"created_time":return h(x,{time:new Date(a.created_time),type:"date",format:"MM-dd HH:MM"});default:return"--"}}});c.value.push({title:"\u64CD\u4F5C",key:"action",width:80,align:"right",render:t=>h(P,{type:"primary",onClick:()=>{D(t.properties.\u94FE\u63A5.rich_text[0].plain_text)}},{default:()=>"\u4FDD\u5B58"})})}})},p=i(),m=()=>JSON.parse(window.localStorage.getItem("pikpakUploadFolder")||"{}"),D=e=>{let t={};if(!m().id)return window.$message.error("\u8BF7\u5148\u8BBE\u7F6E\u9ED8\u8BA4\u4E0A\u4F20\u76EE\u5F55"),!1;if(e.indexOf("PikPak://")===0){const s=e.substring(9).split("|");t={kind:"drive#file",parent_id:m().id,name:s[0],size:s[1],hash:s[2],upload_type:"UPLOAD_TYPE_RESUMABLE",objProvider:{provider:"UPLOAD_TYPE_UNKNOWN"}}}else t={kind:"drive#file",name:"",upload_type:"UPLOAD_TYPE_URL",url:{url:e},params:{from:"file"},folder_type:"DOWNLOAD"};S.post("https://api-drive.mypikpak.com/drive/v1/files",t).then(s=>{(s.data.upload_type==="UPLOAD_TYPE_UNKNOWN"||e.indexOf("PikPak://")===-1)&&window.$message.success("\u6DFB\u52A0\u6210\u529F")})},k=e=>{e.target.offsetHeight-e.target.scrollTop<30&&o.value&&!d.value&&y()};return N(()=>{p.value=m(),o.value="",y()}),(e,t)=>(_(),F("div",M,[r(l(v),{title:"\u611F\u8C22@shabitt",type:"info",closable:""},{default:n(()=>[r(l(U),null,{default:n(()=>[H,j]),_:1})]),_:1}),z,!p.value||!p.value.id?(_(),g(l(v),{key:0,title:"\u8BF7\u5148\u8BBE\u7F6E\u9ED8\u8BA4\u4E0A\u4F20\u76EE\u5F55",type:"error"},{default:n(()=>[V]),_:1})):(_(),g(l(v),{key:1,title:"\u9ED8\u8BA4\u76EE\u5F55",type:"success"},{default:n(()=>[E(w(p.value.name),1)]),_:1})),Y,r(l(A),{style:{"max-height":"calc(100vh - 300px)"},onScroll:k},{default:n(()=>[r(l(C),{bordered:!1,size:"small",data:u.value,columns:c.value},null,8,["data","columns"]),d.value?(_(),F("div",W,[r(l(O),{size:"small"}),K])):T("",!0)]),_:1})]))}});export{G as default};
